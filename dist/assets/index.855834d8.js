var t=function(e,n){return this instanceof t?e instanceof t?e:((e="string"==typeof e?this.select(e,n):e)&&e.nodeName&&(e=[e]),void(this.nodes=this.slice(e))):new t(e,n)};t.prototype={get length(){return this.nodes.length}},t.prototype.nodes=[],t.prototype.addClass=function(){return this.eacharg(arguments,(function(t,e){t.classList.add(e)}))},t.prototype.adjacent=function(e,n,r){return"number"==typeof n&&(n=0===n?[]:new Array(n).join().split(",").map(Number.call,Number)),this.each((function(o,i){var s=document.createDocumentFragment();t(n||{}).map((function(n,r){return"string"==typeof(r="function"==typeof e?e.call(this,n,r,o,i):e)?this.generate(r):t(r)})).each((function(e){this.isInPage(e)?s.appendChild(t(e).clone().first()):s.appendChild(e)})),r.call(this,o,s)}))},t.prototype.after=function(t,e){return this.adjacent(t,e,(function(t,e){t.parentNode.insertBefore(e,t.nextSibling)}))},t.prototype.append=function(t,e){return this.adjacent(t,e,(function(t,e){t.appendChild(e)}))},t.prototype.args=function(t,e,n){return(t="string"!=typeof(t="function"==typeof t?t(e,n):t)?this.slice(t).map(this.str(e,n)):t).toString().split(/[\s,]+/).filter((function(t){return t.length}))},t.prototype.array=function(e){var n=this;return this.nodes.reduce((function(r,o,i){var s;return e?(s="string"==typeof(s=(s=e.call(n,o,i))||!1)?t(s):s)instanceof t&&(s=s.nodes):s=o.innerHTML,r.concat(!1!==s?s:[])}),[])},t.prototype.attr=function(t,e,n){return n=n?"data-":"",this.pairs(t,e,(function(t,e){return t.getAttribute(n+e)}),(function(t,e,r){r?t.setAttribute(n+e,r):t.removeAttribute(n+e)}))},t.prototype.before=function(t,e){return this.adjacent(t,e,(function(t,e){t.parentNode.insertBefore(e,t)}))},t.prototype.children=function(t){return this.map((function(t){return this.slice(t.children)})).filter(t)},t.prototype.clone=function(){return this.map((function(t,e){var n=t.cloneNode(!0),r=this.getAll(n);return this.getAll(t).each((function(t,e){for(var n in this.mirror)this.mirror[n]&&this.mirror[n](t,r.nodes[e])})),n}))},t.prototype.getAll=function(e){return t([e].concat(t("*",e).nodes))},t.prototype.mirror={},t.prototype.mirror.events=function(e,n){if(e._e)for(var r in e._e)e._e[r].forEach((function(e){t(n).on(r,e.callback)}))},t.prototype.mirror.select=function(e,n){t(e).is("select")&&(n.value=e.value)},t.prototype.mirror.textarea=function(e,n){t(e).is("textarea")&&(n.value=e.value)},t.prototype.closest=function(e){return this.map((function(n){do{if(t(n).is(e))return n}while((n=n.parentNode)&&n!==document)}))},t.prototype.data=function(t,e){return this.attr(t,e,!0)},t.prototype.each=function(t){return this.nodes.forEach(t.bind(this)),this},t.prototype.eacharg=function(t,e){return this.each((function(n,r){this.args(t,n,r).forEach((function(t){e.call(this,n,t)}),this)}))},t.prototype.empty=function(){return this.each((function(t){for(;t.firstChild;)t.removeChild(t.firstChild)}))},t.prototype.filter=function(e){var n=e instanceof t?function(t){return-1!==e.nodes.indexOf(t)}:"function"==typeof e?e:function(t){return t.matches=t.matches||t.msMatchesSelector||t.webkitMatchesSelector,t.matches(e||"*")};return t(this.nodes.filter(n))},t.prototype.find=function(e){return this.map((function(n){return t(e||"*",n)}))},t.prototype.first=function(){return this.nodes[0]||!1},t.prototype.generate=function(e){return/^\s*<tr[> ]/.test(e)?t(document.createElement("table")).html(e).children().children().nodes:/^\s*<t(h|d)[> ]/.test(e)?t(document.createElement("table")).html(e).children().children().children().nodes:/^\s*</.test(e)?t(document.createElement("div")).html(e).children().nodes:document.createTextNode(e)},t.prototype.handle=function(){var t=this.slice(arguments).map((function(t){return"function"==typeof t?function(e){e.preventDefault(),t.apply(this,arguments)}:t}),this);return this.on.apply(this,t)},t.prototype.hasClass=function(){return this.is("."+this.args(arguments).join("."))},t.prototype.html=function(t){return void 0===t?this.first().innerHTML||"":this.each((function(e){e.innerHTML=t}))},t.prototype.is=function(t){return 0<this.filter(t).length},t.prototype.isInPage=function(t){return t!==document.body&&document.body.contains(t)},t.prototype.last=function(){return this.nodes[this.length-1]||!1},t.prototype.map=function(e){return e?t(this.array(e)).unique():this},t.prototype.not=function(e){return this.filter((function(n){return!t(n).is(e||!0)}))},t.prototype.off=function(e,n,r){var o=null==n&&null==r,i=null,s=n;return"string"==typeof n&&(i=n,s=r),this.eacharg(e,(function(e,n){t(e._e?e._e[n]:[]).each((function(t){(o||t.orig_callback===s&&t.selector===i)&&e.removeEventListener(n,t.callback)}))}))},t.prototype.on=function(e,n,r){function o(t,e){try{Object.defineProperty(t,"currentTarget",{value:e,configurable:!0})}catch(n){}}var i=null,s=n;function c(t){return n.apply(this,[t].concat(t.detail||[]))}return"string"==typeof n&&(i=n,s=r,n=function(e){var n=arguments;t(e.currentTarget).find(i).each((function(t){var i;t.contains(e.target)&&(i=e.currentTarget,o(e,t),r.apply(t,n),o(e,i))}))}),this.eacharg(e,(function(t,e){t.addEventListener(e,c),t._e=t._e||{},t._e[e]=t._e[e]||[],t._e[e].push({callback:c,orig_callback:s,selector:i})}))},t.prototype.pairs=function(t,e,n,r){var o;return void 0!==e&&(o=t,(t={})[o]=e),"object"==typeof t?this.each((function(e,n){for(var o in t)"function"==typeof t[o]?r(e,o,t[o](e,n)):r(e,o,t[o])})):this.length?n(this.first(),t):""},t.prototype.param=function(t){return Object.keys(t).map(function(e){return this.uri(e)+"="+this.uri(t[e])}.bind(this)).join("&")},t.prototype.parent=function(t){return this.map((function(t){return t.parentNode})).filter(t)},t.prototype.prepend=function(t,e){return this.adjacent(t,e,(function(t,e){t.insertBefore(e,t.firstChild)}))},t.prototype.remove=function(){return this.each((function(t){t.parentNode&&t.parentNode.removeChild(t)}))},t.prototype.removeClass=function(){return this.eacharg(arguments,(function(t,e){t.classList.remove(e)}))},t.prototype.replace=function(e,n){var r=[];return this.adjacent(e,n,(function(t,e){r=r.concat(this.slice(e.children)),t.parentNode.replaceChild(e,t)})),t(r)},t.prototype.scroll=function(){return this.first().scrollIntoView({behavior:"smooth"}),this},t.prototype.select=function(e,n){return e=e.replace(/^\s*/,"").replace(/\s*$/,""),/^</.test(e)?t().generate(e):(n||document).querySelectorAll(e)},t.prototype.serialize=function(){var e=this;return this.slice(this.first().elements).reduce((function(n,r){return!r.name||r.disabled||"file"===r.type||/(checkbox|radio)/.test(r.type)&&!r.checked?n:"select-multiple"===r.type?(t(r.options).each((function(t){t.selected&&(n+="&"+e.uri(r.name)+"="+e.uri(t.value))})),n):n+"&"+e.uri(r.name)+"="+e.uri(r.value)}),"").slice(1)},t.prototype.siblings=function(t){return this.parent().children(t).not(this)},t.prototype.size=function(){return this.first().getBoundingClientRect()},t.prototype.slice=function(t){return t&&0!==t.length&&"string"!=typeof t&&"[object Function]"!==t.toString()?t.length?[].slice.call(t.nodes||t):[t]:[]},t.prototype.str=function(t,e){return function(n){return"function"==typeof n?n.call(this,t,e):n.toString()}},t.prototype.text=function(t){return void 0===t?this.first().textContent||"":this.each((function(e){e.textContent=t}))},t.prototype.toggleClass=function(t,e){return!!e===e?this[e?"addClass":"removeClass"](t):this.eacharg(t,(function(t,e){t.classList.toggle(e)}))},t.prototype.trigger=function(t){var e=this.slice(arguments).slice(1);return this.eacharg(t,(function(t,n){var r,o={bubbles:!0,cancelable:!0,detail:e};try{r=new window.CustomEvent(n,o)}catch(i){(r=document.createEvent("CustomEvent")).initCustomEvent(n,!0,!0,e)}t.dispatchEvent(r)}))},t.prototype.unique=function(){return t(this.nodes.reduce((function(t,e){return null!=e&&!1!==e&&-1===t.indexOf(e)?t.concat(e):t}),[]))},t.prototype.uri=function(t){return encodeURIComponent(t).replace(/!/g,"%21").replace(/'/g,"%27").replace(/\(/g,"%28").replace(/\)/g,"%29").replace(/\*/g,"%2A").replace(/%20/g,"+")},t.prototype.wrap=function(e){return this.map((function(n){return t(e).each((function(e){(function(e){for(;e.firstElementChild;)e=e.firstElementChild;return t(e)})(e).append(n.cloneNode(!0)),n.parentNode.replaceChild(e,n)}))}))},"object"==typeof module&&module.exports&&(module.exports=t,module.exports.u=t);const e={text:"Button",run:()=>{},cmd:"",criteria:()=>!0,listen:!1};class n{constructor(n){if(this.options=n||e,this.options.text=this.options.text||e.text,this.options.run=this.options.run||e.run,this.options.cmd=this.options.cmd||e.cmd,this.options.criteria=this.options.criteria||e.criteria,this.options.listen=this.options.listen||e.listen,this.id=Math.ceil(1e5*Math.random()),this.options.listen&&this.options.cmd){let e=this.options.cmd.replace(/ /,"").toLowerCase().split("+");t("html").on("keydown",(t=>{if(!t.isTrusted)return;let n=e;if(n.filter((t=>t.match(/^(ctrl|control)$/g))).length){if(n=n.filter((t=>!t.match(/^(ctrl|control)$/g))),!t.ctrlKey)return}else if(t.ctrlKey)return;if(n.filter((t=>t.match(/^(alt)$/g))).length){if(n=n.filter((t=>!t.match(/^(alt)$/g))),!t.altKey)return}else if(t.altKey)return;if(n.filter((t=>t.match(/^(shift)$/g))).length){if(n=n.filter((t=>!t.match(/^(shift)$/g))),!t.shiftKey)return}else if(t.shiftKey)return;if(n.filter((t=>t.match(/^(win|windows|cmd|command)$/g))).length){if(n=n.filter((t=>!t.match(/^(win|windows|cmd|command)$/g))),!t.metaKey)return}else if(t.metaKey)return;(n.indexOf(t.key.toLowerCase())>=0||n.indexOf(t.code.toLowerCase())>=0)&&(t.preventDefault(),this.options.run(t))}))}}elm(e,n){let r=t("<table>").attr("id",this.id).addClass("button");return r.append(t("<td>").addClass("text").text(this.options.text)),this.options.cmd&&r.append(t("<td>").addClass("cmd").text(this.options.cmd)),this.options.run&&(r.on("click",(t=>{this.options.run(t,e),n.close(t)})),r.on("contextmenu",(t=>{this.options.run(t,e),n.close(t)}))),r}}const r={light:{background:"#FFFFFF",text:"#1c1c1c",cmd:"#828481",border:"#e3e5e8",shadow:"0 5px 10px 0 rgba(0, 0, 0, 0.2), 0 5px 10px 0 rgba(0, 0, 0, 0.2)",hover:{background:"#E8E8E9",text:"",cmd:"#1c1c1c"}},dark:{background:"#292A2D",text:"#e6e6e6",cmd:"#828481",border:"#373a3d",shadow:"0 5px 10px 0 rgba(0, 0, 0, 0.2), 0 5px 10px 0 rgba(0, 0, 0, 0.2)",hover:{background:"#3F4042",text:"",cmd:"#e6e6e6"}}};window.menu=new class{constructor(e){this.id=Math.ceil(1e5*Math.random()),this.buttons=[],this.menu=t("<iframe>").attr("id",`__context-menu_${this.id}__`).addClass("__context-menu_hidden__"),t("body").append(this.menu);let n=function(t,e){return Object.assign(e,r),{internal:`\n      :root {\n        --bg: ${e.light.background};\n        --bg-hover: ${e.light.hover.background};\n        --text: ${e.light.text};\n        --text-hover: ${e.light.hover.text};\n        --cmd: ${e.light.cmd};\n        --cmd-hover: ${e.light.hover.cmd};\n        --border: ${e.light.border};\n      }\n\n      @media (prefers-color-scheme: dark) {\n        :root {\n          --bg: ${e.dark.background};\n          --bg-hover: ${e.dark.hover.background};\n          --text: ${e.dark.text};\n          --text-hover: ${e.dark.hover.text};\n          --cmd: ${e.dark.cmd};\n          --cmd-hover: ${e.dark.hover.cmd};\n          --border: ${e.dark.border};\n        }\n      }\n\n      body {\n        margin: 0;\n        background: var(--bg);\n      }\n\n      .menu {\n \t      background: var(--bg);\n        position: fixed;\n        font-family: sans-serif;\n        padding: 10px 0 10px 0;\n        width: 250px;\n        user-select: none;\n      }\n\n      .menu .button {\n        font-size: 12px;\n        padding: 4px 15px 4px 15px;\n        width: 250px;\n      }\n\n      .menu .button td {\n        padding: 0;\n      }\n\n      .menu .button .text {\n        color: var(--text);\n        text-align: left;\n      }\n\n      .menu .button .cmd {\n        color: var(--cmd);\n        text-align: right;\n      }\n\n      ${e.light.hover.background||e.dark.hover.background?"\n        .menu .button:hover {\n          background: var(--bg-hover);\n        }\n        ":""}\n\n      ${e.light.hover.text||e.dark.hover.text?"\n        .menu .button:hover .text {\n          color: var(--text-hover);\n        }\n        ":""}\n\n      ${e.light.hover.cmd||e.dark.hover.cmd?"\n        .menu .button:hover .cmd {\n          color: var(--cmd-hover);\n        }\n        ":""}\n\n      .separator {\n        border: 0;\n        border-bottom: 1px solid var(--border);\n        margin: 5px 0 5px 0;\n      }\n    `.replace(/(  |\n)/g,""),external:`\n      :root {\n        --shadow: ${e.light.shadow};\n      }\n\n      @media (prefers-color-scheme: dark) {\n        :root {\n          --shadow: ${e.dark.shadow};\n        }\n      }\n\n      #__context-menu_${t}__ {\n        box-shadow: var(--shadow);\n        border: 0;\n        position: fixed;\n        border-radius: 10px;\n      }\n\n      .__context-menu_hidden__ {\n        display: none;\n      }\n    `.replace(/(  |\n)/g,"")}}(this.id,e.style||{});this.style=t("<style>").html(n.internal),t(this.menu.first().contentDocument.head).append(this.style),t("head").append(t("<style>").html(n.external)),t("html").on("click",(t=>{t.preventDefault(),this.close(t)})),t(this.menu.first().contentDocument).on("click",(t=>{t.preventDefault(),this.close(t)})),t(this.menu.first().contentDocument).on("contextmenu",(t=>{t.preventDefault(),this.close(t)})),t("html").on("contextmenu",(t=>{t.preventDefault(),this.close(t),this.open(t)}))}addButton(t){this.buttons.push(t)}removeButton(t){this.buttons=this.buttons.filter((e=>e.id!==t.id))}getButton(t){return this.buttons.find((e=>e.id===t))}addSeparator(){this.buttons.push("SEP")}addSep(){this.addSeparator()}open(e){this.menu.removeClass("__context-menu_hidden__"),t(this.menu.first().contentDocument.body).append(t("<div>").addClass("menu"));let n=[];if(this.buttons.forEach((r=>{if("SEP"===r){let e=t("<div>").addClass("separator");t(this.menu.first().contentDocument.body).find(".menu").append(e)}else{r.options.criteria(e)&&(n.push(r),t(this.menu.first().contentDocument.body).find(".menu").append(r.elm(e,this)))}})),!n.length)return this.close(e);let r=e.clientX,o=e.clientY,i=t(this.menu.first().contentDocument.body).find(".menu").first().offsetWidth,s=t(this.menu.first().contentDocument.body).find(".menu").first().offsetHeight;r>window.innerWidth-i&&(r-=i),o>window.innerHeight-s&&(o-=s),this.menu.first().style.left=r+"px",this.menu.first().style.top=o+"px",this.menu.first().style.width=i+"px",this.menu.first().style.height=s+"px"}close(e){this.menu.addClass("__context-menu_hidden__"),t(this.menu.first().contentDocument.body).html("")}}({}),menu.addButton(new n({text:"Alert",cmd:"Shift+R",run:function(t){"click"===t.type?window.alert("Button Pressed"):window.alert("Command Run")},listen:!0})),menu.addSep(),menu.addButton(new n({text:"Console Log",cmd:"Shift+C",run:function(t){"click"===t.type?console.log("Button Pressed"):console.log("Command Run")},listen:!1}));
